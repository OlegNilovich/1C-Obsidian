Сохраняем табличный документ как html текст, отправляем на почту используя протокол smtp. Плюс в том, что при открытии сообщения на почте сразу будем видеть отчет (не прибегая к скачиванию файла)

```bsl
// Описание ПочтовогоПрофиля;
ПочтовыйПрофиль  = Новый ИнтернетПочтовыйПрофиль;

// SMTP (отправляем сообщение);    
ПочтовыйПрофиль.АдресСервераSMTP = "smtp.yandex.com";
//ПочтовыйПрофиль.АдресСервераIMAP = "imap.yandex.com";

ПочтовыйПрофиль.ПользовательSMTP = "xxxxx.xxxxxx@yandex.ru";
ПочтовыйПрофиль.ПарольSMTP 	= "tcbbrwraduriuusz"; 

ПочтовыйПрофиль.Пользователь = "xxxxx.xxxxxx@yandex.ru";
ПочтовыйПрофиль.Пароль = "tcbbrwraduriuusz";

ПочтовыйПрофиль.ПортSMTP = 465; 
//ПочтовыйПрофиль.ПортIMAP = 993;
ПочтовыйПрофиль.Таймаут = 30; // мс;

ПочтовыйПрофиль.ИспользоватьSSLSMTP = Истина;
ПочтовыйПрофиль.ИспользоватьSSLIMAP = Истина;

// ИнтернетПочта;
Почта = Новый ИнтернетПочта;

ПодключеноУспешно = Ложь;
Попытка
	Почта.Подключиться(ПочтовыйПрофиль, ПротоколИнтернетПочты.IMAP);
	ПодключеноУспешно = Истина;
Исключение
КонецПопытки;

// Проверка;
Если НЕ ПодключеноУспешно Тогда
	ЖурналРегистрации.ДобавитьСообщениеДляЖурналаРегистрации(ОписаниеОшибки(), 
	УровеньЖурналаРегистрации.Ошибка,,,  "Сообщение- не было отправлено!");  
	Возврат;
Иначе
	
	АдресФайлаВложения = ПолучитьИмяВременногоФайла(".txt");
	
	// Формирование отчета;
	ТаблДок = Новый ТабличныйДокумент;
	// Формируем отчет (какой хотим);
	Отчеты.ABCXYZАнализНоменклатуры.Создать().СкомпоноватьРезультат(ТаблДок);   
	ТаблДок.Записать(АдресФайлаВложения, ТипФайлаТабличногоДокумента.HTML);
	
	ТекстHTML = "";
	ТекДок = Новый ТекстовыйДокумент;
	ТекДок.Прочитать(АдресФайлаВложения);
	ТекстHTML = ТекДок.ПолучитьТекст();
	
	// Формирование сообщения;
	ПочтовоеСообщение = Новый ИнтернетПочтовоеСообщение;
	ПочтовоеСообщение.Тема = СтрШаблон("Отчет ""Остатки товаров "" от %1", Формат(ТекущаяДата(), "ДЛФ=DD"));
	ПочтовоеСообщение.Важность 	= ВажностьИнтернетПочтовогоСообщения.Наивысшая;
	ПочтовоеСообщение.Тексты.Добавить(ТекстHTML, ТипТекстаПочтовогоСообщения.HTML);
	//
	ПочтовоеСообщение.Отправитель.Адрес = "xxxxx.xxxxxx@yandex.ru";
	ПочтовоеСообщение.Получатели.Добавить("xxxxx.xxxxxx@yandex.ru");  
	
	//ИнтернетПочтовоеВложение  = ПочтовоеСообщение.Вложения.Добавить(АдресФайлаВложения, "Остатки товаров организаций");
	
	Попытка
		СоответствиеОтвет = Почта.Послать(ПочтовоеСообщение,, ПротоколИнтернетПочты.SMTP);	
	Исключение
	КонецПопытки;
	
КонецЕсли;
```