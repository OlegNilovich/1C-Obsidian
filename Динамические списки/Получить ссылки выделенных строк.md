```bsl
// 1. Выделяем несколько строк в динамическом списке
// 2. Получаем массив ссылок этих элементов
&НаКлиенте
Процедура ПолучитьДанныеВыделенныхСтрок(Команда)
	
	МассивСсылокТоваров = Элементы.Товары.ВыделенныеСтроки;
	ИзменитьВидыТоваров(МассивСсылокТоваров);

КонецПроцедуры

// 3. Для обработки ссылок, требуется процедура без контекста!
&НаСервереБезКонтекста
Процедура ИзменитьВидыТоваров(МассивСсылокТоваров)
	
	Для каждого Товар Из МассивСсылокТоваров Цикл
		ТоварОбъект = ТекЗаказ.ПолучитьОбъект();
		ТоварОбъект.ВидНоменклатуры = Перечисления.ВидыНоменклатуры.Услуга;
		ТоварОбъект.Записать();
	КонецЦикла;
	
КонецПроцедуры
```