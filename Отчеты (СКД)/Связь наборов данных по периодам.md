#ОТЧЕТЫ 
### Задача:
Требуется создать отчет, который будет показывать сумму продаж товаров в рублях и в выбранной валюте за указанный период с разбивкой по дням.
Курс должен определяться в зависимости от дня продажи. 
Например *07.11.21* и *08.11.21* курс **Евро** составлял 101 рубль, а *14.12.21* курс **Евро** был 200 рублей. 
Одна и та же сумма продажи в **Рублях**: 72 000,00 будет иметь разную сумму продаж в **Евро**: 707 и 360
![[Pasted image 20240923024619.png]]
### Решение:
1. Создаем отчет **ПродажиВВалюте**, создаем и открываем *ОсновнаяСхемаКомпоновкиДанных*
2. Вкладка **Наборы данных** => Добавляем набор данных *Запрос* => Текст запроса:
```bsl
ВЫБРАТЬ
	ПродажиОбороты.Период КАК Период,
	ПродажиОбороты.Номенклатура КАК Номенклатура,
	ПродажиОбороты.СуммаОборот КАК СуммаВРублях
ИЗ
	РегистрНакопления.Продажи.Обороты(, , День, ) КАК ПродажиОбороты
```
3. Вкладка **Наборы данных** => Добавляем набор данных *Запрос* => Текст запроса:
```bsl
ВЫБРАТЬ
	&ДатаПолученияКурса КАК ДатаПолученияКурса,
	КурсыВалютСрезПоследних.Курс КАК Курс,
	КурсыВалютСрезПоследних.Кратность КАК Кратность
{ВЫБРАТЬ
	Курс,
	Кратность,
	ДатаПолученияКурса}
ИЗ
	РегистрСведений.КурсыВалют.СрезПоследних(&ДатаПолученияКурса, Валюта = &Валюта) КАК КурсыВалютСрезПоследних
```
4. Вкладка **Связи наборов данных** => Связываем наборы данных
![[Pasted image 20240923025654.png]]
5. **Вычисляемые поля** => Добавляем поле *СуммаВВалюте* => Выражение: *СуммаВРублях / Курс*
![[Pasted image 20240923025726.png]]
6. Вкладка **Ресурсы** => Определяем два ресурса: *СуммаВРублях* и *СуммаВВалюте*
![[Pasted image 20240923025850.png]]
7. Вкладка **Параметры** => Определяем параметры
![[Pasted image 20240923030016.png]]
8. Создаем группировку по полю **Номенклатура** и вложенную группировку **Детальные записи**
9. Определяем выбранные поля: *Период*, *Курс*, *СуммаВРублях*, *СуммаВВалюте*
![[Pasted image 20240923030326.png]]
10. **Настройки** => **Параметры** => Добавляем все три параметра в состав пользовательских настроек
![[Pasted image 20240923030145.png]]
11. Настройки => Другие настройки => Макет оформления => **Античный**