#ОТЧЕТЫ 

```bsl
&НаКлиенте
Процедура ОтправитьПисьмо(Команда)

	Оповещение = Новый ОписаниеОповещения("ПослеВводаПолучателя", ЭтотОбъект);
	ПоказатьВводСтроки(Оповещение,, "Введите email"); 

КонецПроцедуры                


&НаКлиенте
Процедура ПослеВводаПолучателя(Получатель, ДополнительныеПараметры) Экспорт
	
	Если Получатель = Неопределено Тогда
		Возврат;
	Иначе
		ВыполнитьОтправкуПисьмаНаСервере(Получатель);
	КонецЕсли;
	
КонецПроцедуры


&НаСервере
Процедура ВыполнитьОтправкуПисьмаНаСервере(Получатель)
	
	Тема = "Прайс-лист - Электрик ООО";
	Текст = "В приложении актуальный прайс нашей компании";
	
	Каталог = КаталогВременныхФайлов();
	ПутьКФайлу = Каталог + "Прайс-лист от Электрик ОООО.xlsx";
	
	Результат.Записать(ПутьКФайлу, ТипФайлаТабличногоДокумента.XLSX);
	
	МассивВложений = Новый Массив;
	МассивВложений.Добавить(ПутьКФайлу);

	МассивПолучателей = Новый Массив; 
	МассивПолучателей.Добавить(Получатель);
	
	РаботаСПочтойСервер.ОтправитьEmail(МассивПолучателей, Тема, Текст, МассивВложений);

КонецПроцедуры


Процедура ОтправитьEmail(Получатели, Тема, ТекстПисьма, Вложения)
	
	//1. Описание профиля (Данные Hardcode)
	Профиль							= Новый ИнтернетПочтовыйПрофиль;
	Профиль.АдресСервераSMTP		= "smtp.yandex.ru";
	Профиль.ПортSMTP				= 465;
	Профиль.ИспользоватьSSLSMTP		= Истина;
	Профиль.ПользовательSMTP		= "testmail.ironskills11@yandex.ru";
	Профиль.ПарольSMTP				= "zlalwmehdncjifal";  
	Профиль.Таймаут					= 20;    
	
	//1. Описание профиля (Данные находятся в элементе справочника)
	УчетнаяЗапись = Справочники.УчетныеЗаписиЭлектроннойПочты.СистемнаяУчетнаяЗапись;

	Профиль							= Новый ИнтернетПочтовыйПрофиль;
	Профиль.АдресСервераSMTP		= УчетнаяЗапись.АдресСервераSMTP;
	Профиль.ПортSMTP				= УчетнаяЗапись.ПортSMTP;
	Профиль.ИспользоватьSSLSMTP		= УчетнаяЗапись.ИспользоватьSSLSMTP;
	Профиль.ПользовательSMTP		= УчетнаяЗапись.ПользовательSMTP;
	Профиль.ПарольSMTP				= УчетнаяЗапись.ПарольSMTP;  
	Профиль.Таймаут					= УчетнаяЗапись.Таймаут;  
	
	//2. Попытка подключения к почтовому серверу
	Попытка
		Почта = Новый ИнтернетПочта;
		Почта.Подключиться(Профиль);
	Исключение
		Сообщить("Ошибка соединения с почтовым сервером. Причина:" + ОписаниеОшибки());
		Возврат;
	КонецПопытки; 
	
	//3. Создание письма
	Письмо = Новый ИнтернетПочтовоеСообщение;
	Письмо.Тема = Тема;
	Письмо.Тексты.Добавить(ТекстПисьма);
	Письмо.Отправитель = УчетнаяЗапись.Отправитель;
	Письмо.ИмяОтправителя = УчетнаяЗапись.ИмяОтправителя;
	
	Для каждого Получатель Из Получатели Цикл
		Письмо.Получатели.Добавить(Получатель);	
	КонецЦикла;
	
	Для каждого Вложение Из Вложения Цикл
		Письмо.Вложения.Добавить(Вложение);  
	КонецЦикла;
	
	//4. Отправка письма получателям
	Попытка
		Почта.Послать(Письмо); 
		Сообщить("Прайс лист отправлен на указанный email");
	Исключение
		Сообщить("Не удалось отправить письмо получателям, причина: " + ОписаниеОшибки());
	КонецПопытки;
	
КонецПроцедуры 
```