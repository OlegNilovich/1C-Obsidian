![[Pasted image 20241009170602.png]]

```bsl
ВЫБРАТЬ
  ДанныеЗапроса.Родитель КАК Родитель,
  ДанныеЗапроса.Уровень КАК Уровень
ИЗ
  (ВЫБРАТЬ
    Номенклатура.Родитель КАК Родитель,
    1 КАК Уровень
  ИЗ
    Справочник.Номенклатура КАК Номенклатура
  ГДЕ
    Номенклатура.Ссылка = &Ссылка
  
  ОБЪЕДИНИТЬ ВСЕ
  
  ВЫБРАТЬ
    Номенклатура.Родитель.Родитель,
    2
  ИЗ
    Справочник.Номенклатура КАК Номенклатура
  ГДЕ
    Номенклатура.Ссылка = &Ссылка
  
  ОБЪЕДИНИТЬ ВСЕ
  
  ВЫБРАТЬ
    Номенклатура.Родитель.Родитель.Родитель,
    3
  ИЗ
    Справочник.Номенклатура КАК Номенклатура
  ГДЕ
    Номенклатура.Ссылка = &Ссылка
  
  ОБЪЕДИНИТЬ ВСЕ
  
  ВЫБРАТЬ
    Номенклатура.Родитель.Родитель.Родитель.Родитель,
    4
  ИЗ
    Справочник.Номенклатура КАК Номенклатура
  ГДЕ
    Номенклатура.Ссылка = &Ссылка
  
  ОБЪЕДИНИТЬ ВСЕ
  
  ВЫБРАТЬ
    Номенклатура.Родитель.Родитель.Родитель.Родитель,
    5
  ИЗ
    Справочник.Номенклатура КАК Номенклатура
  ГДЕ
    Номенклатура.Ссылка = &Ссылка) КАК ДанныеЗапроса
ГДЕ
  ДанныеЗапроса.Родитель <> ЗНАЧЕНИЕ(Справочник.Номенклатура.ПустаяСсылка)
```