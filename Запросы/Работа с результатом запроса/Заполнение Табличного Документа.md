#ЗАПРОСЫ
### Задача:
Требуется создать обработку, которая будет показывать сумму и количество оборотов продаж товаров, в разрезе контрагентов и с итогами по контрагенам. В виде табличного документа
![[Pasted image 20240902161257.png]]
### Решение:
1. Создаем обработку, форму обработки. Открываем редактор формы
2. Создаем реквизит "ТабДок" тип (ТабличныйДокумент)
3. Переносим реквизит "ТабДок" на форму
![[Pasted image 20240902155958.png]]
4. Создаем команду "ЗаполнитьТабличныйДокумент"
5. Переносим ее на форму и создаем обработчик действия команды
6. Модуль формы:
```bsl
&НаКлиенте
Процедура ЗаполнитьТабличныйДокумент(Команда)
	ЗаполнитьТабличныйДокументНаСервере();
КонецПроцедуры

&НаСервере
Процедура ЗаполнитьТабличныйДокументНаСервере()
	
	Макет = Обработки.ЗаполнениеТабличногоДокумента.ПолучитьМакет("Макет");
	Запрос = Новый Запрос;
	Запрос.Текст = 
		"ВЫБРАТЬ
		|	ПродажиОбороты.Контрагент КАК										Контрагент,
		|	ПРЕДСТАВЛЕНИЕ(ПродажиОбороты.Контрагент) КАК			КонтрагентПредставление,
		|	ПродажиОбороты.Номенклатура КАК									Номенклатура,
		|	ПРЕДСТАВЛЕНИЕ(ПродажиОбороты.Номенклатура) КАК		НоменклатураПредставление,
		|	ПродажиОбороты.КоличествоОборот КАК							КоличествоОборот,
		|	ПродажиОбороты.СуммаОборот КАК									СуммаОборот
		|ИЗ
		|	РегистрНакопления.Продажи.Обороты КАК						ПродажиОбороты";
	
	РезультатЗапроса = Запрос.Выполнить();
	
	ОбластьЗаголовок				= Макет.ПолучитьОбласть("Заголовок");
	ОбластьПодвал					= Макет.ПолучитьОбласть("Подвал");
	ОбластьШапкаТаблицы		= Макет.ПолучитьОбласть("ШапкаТаблицы");
	ОбластьПодвалТаблицы		= Макет.ПолучитьОбласть("ПодвалТаблицы");
	ОбластьДетальныхЗаписей	= Макет.ПолучитьОбласть("Детали");
	
	ТабДок.Очистить();
	ТабДок.Вывести(ОбластьЗаголовок);
	ТабДок.Вывести(ОбластьШапкаТаблицы);
	ТабДок.НачатьАвтогруппировкуСтрок();
	
	ВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();
	
	Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
		ОбластьДетальныхЗаписей.Параметры.Заполнить(ВыборкаДетальныеЗаписи);
		ТабДок.Вывести(ОбластьДетальныхЗаписей, ВыборкаДетальныеЗаписи.Уровень());
	КонецЦикла;
	
	ТабДок.ЗакончитьАвтогруппировкуСтрок();
	ТабДок.Вывести(ОбластьПодвалТаблицы);
	ТабДок.Вывести(ОбластьПодвал);
	
КонецПроцедуры
```