#ЗАПРОСЫ

1. Создаем обработку "ПараметрыЗапроса"
2. Создаем табличную часть обработки "Товары" и ее колонки:
- Номенклатура (СправочникСсылка.Номенклатура)
- Количество (Число, 10, 0)
3. Создаем форму обработки и переносим на форму табличную часть "Товары"
![[Pasted image 20240903091407.png]]
4. Создаем обработчик события формы "ПриСозданииНаСервере"
![[Pasted image 20240903091622.png]]
5. Модуль формы:
```bsl
&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	НоваяСтрока = Объект.Товары.Добавить();
	НоваяСтрока.Номенклатура = 
	Справочники.Номенклатура.НайтиПоНаименованию("Смартфон POCO X3");
	НоваяСтрока.Количество = 3;
	
	НоваяСтрока = Объект.Товары.Добавить();
	НоваяСтрока.Номенклатура = 
	Справочники.Номенклатура.НайтиПоНаименованию("Духовка Hansa Boei68431");
	НоваяСтрока.Количество = 5;
	
	НоваяСтрока = Объект.Товары.Добавить();
	НоваяСтрока.Номенклатура = 
	Справочники.Номенклатура.НайтиПоНаименованию("Морозильник Indesit DFZ 4150");
	НоваяСтрока.Количество = 7;
КонецПроцедуры

&НаКлиенте
Процедура ПараметрТабличнаяЧасть(Команда)
	ПараметрТабличнаяЧастьНаСервере();
КонецПроцедуры
&НаСервере
Процедура ПараметрТабличнаяЧастьНаСервере()
	
	// 1. Создаем запрос, который поместит табличную часть документа во временную таблицу
	Запрос = Новый Запрос;
	Запрос.МенеджерВременныхТаблиц = Новый МенеджерВременныхТаблиц;
	Запрос.Текст = 
	"ВЫБРАТЬ
	|	ТабличнаяЧасть.Номенклатура КАК		Номенклатура,
	|	ТабличнаяЧасть.Количество КАК			Количество
	|ПОМЕСТИТЬ ВТ_ТабличнаяЧасть
	|ИЗ
	|	&ТабличнаяЧасть КАК ТабличнаяЧасть";
	Запрос.УстановитьПараметр("ТабличнаяЧасть", Объект.Товары.Выгрузить());
	Запрос.Выполнить();

	// 2. Используем рвременную таблицу для соединения с таблицей "ЦеныНоменклатуры"
	Запрос.Текст = "ВЫБРАТЬ
	|	ВТ_ТабличнаяЧасть.Номенклатура КАК		Номенклатура,
	|	ВТ_ТабличнаяЧасть.Количество КАК			Количество,
	|	ЕСТЬNULL(Цены.Цена, 0) КАК					Цена
	|ИЗ
	|	ВТ_ТабличнаяЧасть КАК ВТ_ТабличнаяЧасть
	|		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ЦеныНоменклатуры.СрезПоследних() КАК Цены
	|		ПО ВТ_ТабличнаяЧасть.Номенклатура = Цены.Номенклатура";
	
	// 3. Обрабатываем результат
	Выборка = Запрос.Выполнить().Выбрать();
	Пока Выборка.Следующий() Цикл
		Текст = "Номенклатура: %1, Количество: %2, Цена: %3";
		Сообщить(СтрШаблон(Текст, Выборка.Номенклатура, Выборка.Количество, Выборка.Цена,));
	КонецЦикла;
	
КонецПроцедуры
```
